<div layout="column" layout-fill>
  <div class="topbar-height" ng-include="'partials/topbar.html'">
  </div>
  <div flex>
    <div layout="row" layout-fill>
      <div class="sidebar-width" ng-include="'partials/sidebar.html'"></div>
      <div
        flex
        md-colors="{background: 'default-background-50'}"
        style="overflow-y: auto;"
      >
        
        <!-- Content -->
        <div layout-fill layout="column">

          <div class="page-header">
            <h1 class="word-break">
              {{webentity.name || 'loading'}}
            </h1>
            <span class="md-subhead">
              Explore and edit this <span hyphe-glossary="web entity"></span>.
            </span>
          </div>

          <div flex layout="row">
            <div layout="column" flex="50">
              <md-tabs md-border-bottom flex md-selected="selectedTab">
            
                <!-- Tab: Identity -->
                <md-tab label="Identity">
                  <div layout-fill md-colors="{'background': 'default-background-200'}" style="overflow-y: auto">
                    <div layout="column">

                      <!-- Info -->
                      <div
                        ng-if="!identityEditMode"
                        style="padding: 8px"
                        md-colors="{'background': 'default-background-200'}"
                        layout="column"
                      >
                        <dl class="key-value-pairs">

                          <dt>ID</dt>
                          <dd>{{webentity.id}}</dd>

                          <dt>Name</dt>
                          <dd>{{webentity.name || '...'}}</dd>

                          <dt>Status</dt>
                          <dd>{{webentity.status || '...'}}</dd>

                          <dt>Home page</dt>
                          <dd>
                            <a href="{{webentity.homepage}}" target="_blank" title="Open in a new tab">
                              <md-tooltip md-direction="left">Open home page in a new tab</md-tooltip>
                              <md-icon>link</md-icon>
                            </a>
                            {{webentity.homepage}}
                          </dd>

                        </dl>

                        <div layout="row" layout-align="center">
                          <md-button class="md-raised" ng-click="enableEditMode()" ng-disabled="webentity.loading">Edit</md-button>
                        </div>
                      </div>

                      <!-- Edit -->
                      <div layout="column" ng-if="identityEditMode" style="padding: 8px" md-colors="{'background': 'default-background-50'}">
                        <md-input-container>
                          <label>Name</label>
                          <input ng-model="$parent.webentityEdit_name">
                        </md-input-container>
                        <md-input-container>
                          <label>Status</label>
                          <md-select ng-model="$parent.webentityEdit_status">
                            <md-option value="IN">IN</md-option>
                            <md-option value="UNDECIDED">UNDECIDED</md-option>
                            <md-option value="OUT">OUT</md-option>
                          </md-select>
                        </md-input-container>
                        <md-input-container>
                          <label>Homepage</label>
                          <input ng-model="$parent.webentityEdit_homepage">
                          <div class="hint" md-colors="{'color': 'default-warn'}">{{homepageErrorMessage}}</div>
                        </md-input-container>
                        <div layout="row" style="padding-bottom: 8px" layout-align="center">
                          <md-button class="md-raised md-primary" ng-click="saveWebEntity()" ng-disabled="identityEditLoading">Save changes</md-button>
                          <md-button class="" ng-click="disableEditMode()" ng-disabled="identityEditLoading">Cancel</md-button>
                        </div>
                      </div>

                      <!-- Other info -->
                      <div style="padding: 8px; margin-top: 16px" md-colors="{'background': 'default-background-200'}">
                        <dl class="key-value-pairs">

                          <dt>Created {{webentity['creation_date']|prettyDate}}</dt>
                          <dd>{{webentity['creation_date']|date}}</dd>
                          
                          <dt>Last modified {{webentity['last_modification_date']|prettyDate}}</dt>
                          <dd>{{webentity['last_modification_date']|date}}</dd>
                          
                          <dt>Cited by</dt>
                          <dd>{{webentity['indegree'] | no}} other entit{{webentity['indegree'] | y_ies}}</dd>
                          
                        </dl>
                      </div>
                    </div>
                  </div>
                </md-tab>

                <!-- Tab: Prefixes -->
                <md-tab label="Prefixes">
                  <md-virtual-repeat-container layout-fill>
                    <md-list>
                        <!-- md-item-size="48" -->
                      <md-list-item
                        md-virtual-repeat="lru in webentity.prefixes"
                        class="crawljob-list-item"
                      >
                        <span md-truncate flex>
                          <a href="{{lru|lru_to_url}}" target="_blank" title="Open in a new tab">
                            <md-tooltip md-direction="left">Open in a new tab</md-tooltip>
                            <md-icon>link</md-icon>
                          </a>
                          {{lru|lru_to_url}}
                        </span>
                        <!-- <md-icon ng-click="" aria-label="Close" class="md-secondary">close</md-icon> -->
                      </md-list-item>
                    </md-list>
                  </md-virtual-repeat-container>
                </md-tab>

                <!-- Tab: Crawls -->
                <md-tab label="Crawls">
                </md-tab>

                <!-- Tab: Tags -->
                <md-tab>
                  <md-tab-label><md-icon>local_offer</md-icon> Tags</md-tab-label>
                  <md-tab-body>
                    <div layout-fill layout="column">
                      <div flex style="overflow-y: auto">
                        <div layout="column" style="padding: 8px">
                          
                          <!-- Free tags -->
                          <div class="md-title">Free tags</div>
                          <md-chips
                            ng-model="tagCategories.FREETAGS"
                            readonly="tagsPendingQueries>0"
                            md-removable="tagsPendingQueries<=0"
                          >
                            <md-autocomplete
                              md-selected-item="selectedItem"
                              md-search-text="searchText"
                              md-items="tag in autoComplete(searchText, 'FREETAGS')"
                              md-item-text="tag"
                              placeholder="+ Tag..."
                            >
                              <span md-highlight-text="searchText">{{tag}}</span>
                            </md-autocomplete>
                          </md-chips>
                          <br>
                          <br>

                          <!-- Tag categories -->
                          <div ng-repeat="(tagCat, tagValues) in tagCategories" ng-if="tagCat != 'FREETAGS'">
                            <div class="md-title">{{tagCat}}</div>
                            <md-chips
                              ng-model="tagCategories[tagCat]"
                              readonly="tagsPendingQueries>0 || tagCategories[tagCat].length > 0"
                              md-removable="tagsPendingQueries<=0"
                              md-max-chips="1"
                            >
                              <md-autocomplete
                                md-selected-item="selectedItem"
                                md-search-text="searchText"
                                md-items="tag in autoComplete(searchText, tagCat)"
                                md-item-text="tag"
                                placeholder="Set tag"
                              >
                                <span md-highlight-text="searchText">{{tag}}</span>
                              </md-autocomplete>
                            </md-chips>
                            <br>
                          </div>


                          <div
                            layout="row"
                            md-colors="{'background': 'default-background-100'}"
                            style="padding: 8px; margin-top: 16px"
                          >
                            <md-input-container flex>
                              <label>New category</label>
                              <input ng-model="newCategory" ng-press-enter="saveNewCategory()">
                            </md-input-container>
                            <md-button class="md-primary" ng-click="saveNewCategory()">Add</md-button>
                          </div>

                        </div>
                      </div>
                      <!-- <div style="padding: 8px" layout="row">
                        <md-button class="md-raised md-primary">Save changes</md-button>
                        <md-button class="">Cancel</md-button>
                      </div> -->
                    </div>
                  </md-tab-body>
                </md-tab>

              </md-tabs>
            </div>
            <div layout="column" flex="50" md-colors="{'background':'default-background-100'}">
              <div
                layout="row"
                style="height: 48px;"
              >
                <h3 style="padding: 8px; margin: 0px">Pages</h3>
                <div flex></div>
                <md-button class="md-raised" disabled="true">
                  <md-icon>equalizer</md-icon>
                  Most cited
                </md-button>
                <md-button class="md-raised" disabled="true">
                  <md-icon>folder</md-icon>
                  as folders
                </md-button>
                <md-button class="md-raised" disabled="true">
                  <md-icon>bubble_chart</md-icon>
                  network
                </md-button>
              </div>
              
              <div style="padding: 8px">
                TODO: pages list
              </div>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>
</div>